<!--<!doctype html>-->
<!--<html lang="en">-->
<!--  <head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <link rel="icon" type="image/svg+xml" href="/vite.svg" />-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0" />-->
<!--    <title>Vite + React</title>-->
<!--  </head>-->
<!--  <body>-->
<!--    <div id="root"></div>-->
<!--    <script type="module" src="/src/main.jsx"></script>-->
<!--  </body>-->
<!--</html>-->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Проверка технического задания - Уральская сталь</title>
  <style>
    /* Импорт шрифта DIN 2014 (используем Inter как замену) */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');

    /* Дизайн-система: Базовые токены */
    :root {
      /* Цветовая палитра */
      --clr-black: #000000;
      --clr-gray-900: #231f20;
      --clr-gray-700: #727272;
      --clr-gray-300: #bfbfbf;
      --clr-white: #ffffff;
      --clr-brand-500: #ff3c00;
      --clr-brand-400: #f37130;
      --clr-brand-600: #f0512c;

      /* Градиент */
      --brand-gradient: linear-gradient(90deg, #ff3c00 0%, #f37130 50%, #f0512c 100%);

      /* Spacing токены (базовая сетка 8pt) */
      --space-1: 8px;
      --space-2: 16px;
      --space-3: 24px;
      --space-4: 32px;
      --space-5: 40px;
      --space-6: 48px;

      /* Радиусы */
      --radius-small: 4px;
      --radius-medium: 12px;
      --radius-large: 24px;

      /* Анимации */
      --motion-duration-fast: 150ms;
      --motion-duration-medium: 300ms;
      --motion-duration-slow: 500ms;
      --motion-ease-standard: cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Dark Theme (по умолчанию) */
    [data-theme="dark"] {
      /* Surfaces */
      --surface-canvas: #121212;
      --surface-subtle: #1e1e1f;
      --surface-elevated: #1f1f1f;
      --border-default: #2e2e2f;

      /* Text */
      --text-primary: #f5f5f5;
      --text-secondary: #bfbfbf;
      --text-inverse: #000000;

      /* Brand */
      --brand-primary: #ff3c00;
      --brand-hover: #f37130;
      --brand-active: #f0512c;
      --focus-ring: 0 0 0 3px rgba(255,60,0,.6);

      /* Shadows */
      --shadow-small: 0 2px 4px rgba(0,0,0,.6);
      --shadow-medium: 0 4px 12px rgba(0,0,0,.48);
    }

    /* Light Theme */
    [data-theme="light"] {
      /* Surfaces */
      --surface-canvas: #ffffff;
      --surface-subtle: #f9f9f9;
      --surface-elevated: #ffffff;
      --border-default: #bfbfbf;

      /* Text */
      --text-primary: #231f20;
      --text-secondary: #727272;
      --text-inverse: #ffffff;

      /* Brand */
      --brand-primary: #ff3c00;
      --brand-hover: #f37130;
      --brand-active: #f0512c;
      --focus-ring: 0 0 0 3px rgba(255,60,0,.4);

      /* Shadows */
      --shadow-small: 0 2px 4px rgba(0,0,0,.08);
      --shadow-medium: 0 4px 12px rgba(0,0,0,.06);
    }

    /* Базовые стили */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--surface-canvas);
      color: var(--text-primary);
      line-height: 1.5;
      overflow-x: hidden;
    }

    /* Компоненты из дизайн-системы */
    .btn-primary {
      background: var(--brand-primary);
      color: var(--text-inverse);
      border: none;
      border-radius: var(--radius-large);
      padding: var(--space-2) var(--space-3);
      font-family: inherit;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: all var(--motion-duration-medium) var(--motion-ease-standard);
      display: inline-flex;
      align-items: center;
      gap: var(--space-1);
      min-height: 56px;
    }

    .btn-primary:hover:not(:disabled) {
      background: var(--brand-hover);
      transform: translateY(-2px);
    }

    .btn-primary:active:not(:disabled) {
      background: var(--brand-active);
      transform: translateY(0);
    }

    .btn-primary:focus-visible {
      outline: var(--focus-ring);
    }

    .btn-primary:disabled {
      background: var(--brand-primary);
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }

    /* Карточки */
    .card {
      background: var(--surface-elevated);
      border-radius: var(--radius-medium);
      box-shadow: var(--shadow-small);
      transition: all var(--motion-duration-medium) var(--motion-ease-standard);
    }

    .card:hover {
      box-shadow: var(--shadow-medium);
      transform: translateY(-2px);
    }

    /* Layouts */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 var(--space-2);
    }

    /* Upload Screen */
    .upload-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: var(--space-3);
      transition: transform var(--motion-duration-slow) var(--motion-ease-standard);
      background: var(--surface-canvas);
    }

    .upload-screen.hidden {
      transform: translateX(-100%);
    }

    .upload-container {
      background: var(--surface-elevated);
      border: 3px dashed var(--border-default);
      border-radius: var(--radius-medium);
      padding: var(--space-6);
      text-align: center;
      max-width: 700px;
      width: 100%;
      transition: all var(--motion-duration-medium) var(--motion-ease-standard);
      position: relative;
      overflow: hidden;
    }

    .upload-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--brand-gradient);
      opacity: 0;
      transition: opacity var(--motion-duration-medium) var(--motion-ease-standard);
      z-index: 0;
    }

    .upload-container.drag-over {
      border-color: var(--brand-primary);
      background: var(--surface-elevated);
      transform: scale(1.02);
      box-shadow: var(--shadow-medium);
    }

    .upload-container.drag-over::before {
      opacity: 0.1;
    }

    .upload-container > * {
      position: relative;
      z-index: 1;
    }

    .upload-icon {
      width: 120px;
      height: 120px;
      margin: 0 auto var(--space-3);
      color: var(--brand-primary);
      transition: all var(--motion-duration-medium) var(--motion-ease-standard);
    }

    .upload-container:hover .upload-icon {
      transform: scale(1.1);
      color: var(--brand-hover);
    }

    .upload-container.drag-over .upload-icon {
      transform: scale(1.15);
      color: var(--brand-active);
    }

    .upload-text {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: var(--space-2);
      color: var(--text-primary);
    }

    .upload-hint {
      color: var(--text-secondary);
      margin-bottom: var(--space-4);
      font-size: 16px;
    }

    .upload-features {
      display: flex;
      justify-content: center;
      gap: var(--space-4);
      margin-bottom: var(--space-4);
      flex-wrap: wrap;
    }

    .upload-feature {
      display: flex;
      align-items: center;
      gap: var(--space-1);
      color: var(--text-secondary);
      font-size: 14px;
    }

    .upload-feature-icon {
      width: 16px;
      height: 16px;
      color: var(--brand-primary);
    }

    .file-input {
      display: none;
    }

    .scan-button {
      margin-top: var(--space-3);
    }

    /* Loading Spinner */
    .spinner {
      width: 20px;
      height: 20px;
      border: 2px solid transparent;
      border-top: 2px solid currentColor;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Results Layout */
    .results-layout {
      display: none;
      grid-template-columns: 1fr 400px;
      height: 100vh;
      opacity: 0;
      transition: opacity var(--motion-duration-slow) var(--motion-ease-standard);
    }

    .results-layout.visible {
      display: grid;
      opacity: 1;
    }

    /* Document Panel */
    .document-panel {
      background: var(--surface-subtle);
      overflow: auto;
      border-right: 1px solid var(--border-default);
      position: relative;
    }

    .document-content {
      background: var(--clr-white);
      margin: var(--space-3);
      padding: var(--space-6);
      border-radius: var(--radius-medium);
      box-shadow: var(--shadow-small);
      min-height: calc(100vh - var(--space-6));
      font-family: 'Times New Roman', serif;
      line-height: 1.6;
      overflow-x: auto;
      overflow-y: auto;
      color: var(--clr-gray-900);
      min-width: 800px; /* Минимальная ширина для предотвращения сжатия */
    }

    .document-page {
      white-space: pre-wrap;
      page-break-after: always;
      margin-bottom: var(--space-4);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid var(--border-default);
      min-width: 750px; /* Фиксированная минимальная ширина страницы */
      word-wrap: normal;
      overflow-wrap: normal;
    }

    .document-page:last-child {
      border-bottom: none;
      page-break-after: auto;
    }

    /* Запрет переноса для элементов документа */
    .document-content h1,
    .document-content h2,
    .document-content h3,
    .document-content p,
    .document-content li {
      white-space: nowrap;
      overflow: visible;
    }

    .document-content table {
      min-width: 600px;
      white-space: nowrap;
    }

    /* Выделение ошибок в тексте */
    .error-highlight {
      background: rgba(255, 60, 0, 0.24);
      padding: 2px 4px;
      border-radius: 3px;
      cursor: pointer;
      transition: background var(--motion-duration-fast) var(--motion-ease-standard);
      position: relative;
    }

    .error-highlight:hover {
      background: rgba(255, 60, 0, 0.4);
    }

    .error-highlight.active {
      background: rgba(255, 60, 0, 0.6);
      box-shadow: 0 0 0 2px var(--brand-primary);
    }

    /* Comments Panel */
    .comments-panel {
      background: var(--surface-subtle);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .comments-header {
      padding: var(--space-3);
      border-bottom: 1px solid var(--border-default);
      background: var(--surface-elevated);
    }

    .comments-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .comments-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-2);
    }

    /* Accordion */
    .accordion-section {
      margin-bottom: var(--space-2);
    }

    .accordion-header {
      background: var(--surface-elevated);
      border: none;
      width: 100%;
      padding: var(--space-2);
      text-align: left;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      cursor: pointer;
      border-radius: var(--radius-small);
      transition: background var(--motion-duration-fast) var(--motion-ease-standard);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .accordion-header:hover {
      background: rgba(255, 255, 255, 0.1); /* Лёгкое осветление для любой темы */
    }

    .accordion-icon {
      transition: transform var(--motion-duration-medium) var(--motion-ease-standard);
    }

    .accordion-section.open .accordion-icon {
      transform: rotate(180deg);
    }

    .accordion-content {
      overflow: hidden;
      transition: max-height var(--motion-duration-medium) var(--motion-ease-standard);
      max-height: 0;
    }

    .accordion-section.open .accordion-content {
      max-height: none;
      overflow: visible;
    }

    /* Comment Card */
    .comment-card {
      background: var(--clr-white);
      border-radius: var(--radius-small);
      padding: var(--space-2);
      margin: var(--space-1) 0;
      cursor: pointer;
      transition: all var(--motion-duration-fast) var(--motion-ease-standard);
      border-left: 4px solid transparent;
      color: var(--clr-gray-900);
    }

    .comment-card:hover {
      border-left-color: var(--brand-primary);
      background: #f5f5f5; /* Очень светло-серый, чуть темнее белого */
      transform: translateX(4px);
    }

    .comment-card.active {
      border-left-color: var(--brand-primary);
      background: #f0f0f0; /* Немного темнее для активного состояния */
      box-shadow: var(--shadow-small);
      transform: translateX(4px);
    }

    .comment-title {
      font-weight: 600;
      color: var(--clr-gray-900);
      margin-bottom: 4px;
    }

    .comment-section {
      font-size: 14px;
      color: var(--brand-primary);
      margin-bottom: 4px;
    }

    .comment-description {
      font-size: 14px;
      color: var(--clr-gray-700);
    }

    /* File status */
    .file-status {
      margin-top: var(--space-2);
      padding: var(--space-2);
      background: var(--clr-white);
      border-radius: var(--radius-small);
      display: none;
      border: 1px solid var(--border-default);
    }

    .file-status.show {
      display: block;
    }

    .file-name {
      font-weight: 500;
      color: var(--clr-gray-900);
    }

    .file-error {
      color: #e02424;
      margin-top: 4px;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .results-layout {
        grid-template-columns: 1fr 350px;
      }
    }

    @media (max-width: 768px) {
      .results-layout {
        grid-template-columns: 1fr;
        grid-template-rows: 1fr auto;
      }

      .comments-panel {
        max-height: 50vh;
      }

      .upload-container {
        padding: var(--space-4);
      }
    }

    /* Theme Switch */
    .theme-toggle {
      position: fixed;
      top: var(--space-2);
      right: var(--space-2);
      z-index: 1000;
      background: var(--surface-elevated);
      border: 1px solid var(--border-default);
      border-radius: var(--radius-small);
      padding: var(--space-1);
      cursor: pointer;
      transition: all var(--motion-duration-fast) var(--motion-ease-standard);
    }

    .theme-toggle:hover {
      background: var(--surface-subtle);
    }
  </style>
</head>
<body data-theme="dark">
<!-- Theme Toggle -->
<button class="theme-toggle" onclick="toggleTheme()">
  🌙/☀️
</button>

<!-- Upload Screen -->
<div class="upload-screen" id="uploadScreen">
  <div class="upload-container" id="uploadContainer">
    <!-- Upload Icon -->
    <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
      <polyline points="14,2 14,8 20,8"/>
      <line x1="12" y1="11" x2="12" y2="17"/>
      <polyline points="9,14 12,11 15,14"/>
    </svg>

    <div class="upload-text">Загрузить техническое задание</div>
    <div class="upload-hint">Перетащите файл сюда или нажмите кнопку</div>

    <div class="upload-features">
      <div class="upload-feature">
        <svg class="upload-feature-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9,11 12,14 22,4"/>
          <path d="m21,16v4a2,2 0 0,1 -2,2H5a2,2 0 0,1 -2,-2V10a2,2 0 0,1 2,-2h4"/>
        </svg>
        <span>Только .doc, .docx</span>
      </div>
      <div class="upload-feature">
        <svg class="upload-feature-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12,6 12,12 16,14"/>
        </svg>
        <span>Быстрое сканирование</span>
      </div>
      <div class="upload-feature">
        <svg class="upload-feature-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 12l2 2 4-4"/>
          <path d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"/>
          <path d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"/>
          <path d="M12 3c0 1-1 3-3 3s-3-2-3-3 1-3 3-3 3 2 3 3"/>
          <path d="M12 21c0-1 1-3 3-3s3 2 3 3-1 3-3 3-3-2-3-3"/>
        </svg>
        <span>Точный анализ</span>
      </div>
    </div>

    <input type="file" id="fileInput" class="file-input" accept=".doc,.docx" onchange="handleFileSelect(event)">
    <button class="btn-primary" onclick="document.getElementById('fileInput').click()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14,2 14,8 20,8"/>
        <line x1="12" y1="11" x2="12" y2="17"/>
        <polyline points="9,14 12,11 15,14"/>
      </svg>
      Загрузить документ
    </button>

    <div class="file-status" id="fileStatus">
      <div class="file-name" id="fileName"></div>
      <div class="file-error" id="fileError"></div>
    </div>

    <button class="btn-primary scan-button" id="scanButton" disabled onclick="startScan()">
      Просканировать техническое задание
    </button>
  </div>
</div>

<!-- Results Layout -->
<div class="results-layout" id="resultsLayout">
  <!-- Document Panel -->
  <div class="document-panel">
    <div class="document-content" id="documentContent">
      <!-- Документ будет загружен здесь -->
    </div>
  </div>

  <!-- Comments Panel -->
  <div class="comments-panel">
    <div class="comments-header">
      <h2 class="comments-title">Поиск ошибок</h2>
    </div>
    <div class="comments-content">
      <!-- Accordion Section 1: Некорректное написание -->
      <div class="accordion-section open" id="incorrectSection">
        <button class="accordion-header" onclick="toggleAccordion('incorrectSection')">
          <span>Некорректное написание (18)</span>
          <span class="accordion-icon">▼</span>
        </button>
        <div class="accordion-content" id="incorrectComments">
          <!-- Комментарии будут добавлены через JS -->
        </div>
      </div>

      <!-- Accordion Section 2: Отсутствуют -->
      <div class="accordion-section" id="missingSection">
        <button class="accordion-header" onclick="toggleAccordion('missingSection')">
          <span>Отсутствуют (14)</span>
          <span class="accordion-icon">▼</span>
        </button>
        <div class="accordion-content" id="missingComments">
          <!-- Комментарии будут добавлены через JS -->
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Переменные состояния
  let currentTheme = 'dark';
  let uploadedFile = null;
  let errorHighlights = [];
  let currentActiveError = null;

  // Переключение темы
  function toggleTheme() {
    currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
    document.body.setAttribute('data-theme', currentTheme);
  }

  // Обработка drag & drop
  const uploadContainer = document.getElementById('uploadContainer');

  uploadContainer.addEventListener('dragover', (e) => {
    e.preventDefault();
    uploadContainer.classList.add('drag-over');
  });

  uploadContainer.addEventListener('dragleave', (e) => {
    e.preventDefault();
    uploadContainer.classList.remove('drag-over');
  });

  uploadContainer.addEventListener('drop', (e) => {
    e.preventDefault();
    uploadContainer.classList.remove('drag-over');

    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleFile(files[0]);
    }
  });

  // Обработка выбора файла
  function handleFileSelect(event) {
    const file = event.target.files[0];
    if (file) {
      handleFile(file);
    }
  }

  // Проверка и обработка файла
  function handleFile(file) {
    const fileStatus = document.getElementById('fileStatus');
    const fileName = document.getElementById('fileName');
    const fileError = document.getElementById('fileError');
    const scanButton = document.getElementById('scanButton');
    const uploadButton = document.querySelector('.btn-primary');

    // Проверка расширения файла
    const allowedExtensions = ['.doc', '.docx'];
    const fileExtension = '.' + file.name.split('.').pop().toLowerCase();

    if (!allowedExtensions.includes(fileExtension)) {
      fileError.textContent = 'Ошибка: поддерживаются только файлы .doc и .docx';
      fileName.textContent = file.name;
      fileStatus.classList.add('show');
      return;
    }

    // Файл корректный
    uploadedFile = file;
    fileName.textContent = file.name;
    fileError.textContent = '';
    fileStatus.classList.add('show');

    // Деактивируем кнопку загрузки и активируем сканирование
    uploadButton.disabled = true;
    scanButton.disabled = false;
  }

  // Запуск сканирования
  function startScan() {
    const scanButton = document.getElementById('scanButton');
    const originalText = scanButton.innerHTML;

    // Показываем индикатор загрузки
    scanButton.innerHTML = `
                <span class="spinner"></span>
                Сканирование...
            `;
    scanButton.disabled = true;

    // Имитация сканирования 3 секунды
    setTimeout(() => {
      showResults();
    }, 3000);
  }

  // Показ результатов
  function showResults() {
    const uploadScreen = document.getElementById('uploadScreen');
    const resultsLayout = document.getElementById('resultsLayout');

    // Переключение экранов
    uploadScreen.classList.add('hidden');

    setTimeout(() => {
      uploadScreen.style.display = 'none';
      resultsLayout.classList.add('visible');

      // Загружаем контент
      loadDocumentContent();
      loadComments();
    }, 500);
  }

  // Загрузка содержимого документа
  function loadDocumentContent() {
    const documentContent = document.getElementById('documentContent');

    // Генерируем типичное техническое задание
    const docContent = generateTechnicalSpecification();
    documentContent.innerHTML = docContent;

    // Добавляем обработчики для выделенных фрагментов
    addErrorHighlightHandlers();
  }

  // Генерация технического задания
  function generateTechnicalSpecification() {
    return `
                <div class="document-page">
                    <h1 style="text-align: center; margin-bottom: 30px;">ТЕХНИЧЕСКОЕ ЗАДАНИЕ</h1>
                    <h2 style="text-align: center; margin-bottom: 30px;">на разработку информационной системы управления производством</h2>

                    <h3>1. ОБЩИЕ ПОЛОЖЕНИЯ</h3>
                    <p><strong>1.1</strong> Настоящее техническое задание определяет требования к созданию <span class="error-highlight" data-error="0">системы управления</span> для предприятия ОАО "Уральская сталь".</p>

                    <p><strong>1.2</strong> Основной целью проекта является <span class="error-highlight" data-error="1">автоматизация процессов</span> управления производством и повышение эффективности работы предприятия.</p>

                    <p><strong>1.3</strong> Система должна обеспечивать <span class="error-highlight" data-error="2">интеграцию с существующим оборудованием</span> и программным обеспечением.</p>

                    <h3>2. НАЗНАЧЕНИЕ И ЦЕЛИ СОЗДАНИЯ СИСТЕМЫ</h3>
                    <p><strong>2.1</strong> Информационная система предназначена для <span class="error-highlight" data-error="3">управления технологическими процессами</span> металлургического производства.</p>

                    <p><strong>2.2</strong> Основные функции системы:</p>
                    <ul>
                        <li>Мониторинг производственных процессов</li>
                        <li><span class="error-highlight" data-error="4">Контроль качества продукции</span></li>
                        <li>Планирование производства</li>
                        <li><span class="error-highlight" data-error="5">Учет сырья и материалов</span></li>
                    </ul>

                    <p><strong>2.3</strong> Система должна поддерживать работу <span class="error-highlight" data-error="6">не менее 500 пользователей</span> одновременно.</p>
                </div>

                <div class="document-page">
                    <h3>3. ХАРАКТЕРИСТИКА ОБЪЕКТА АВТОМАТИЗАЦИИ</h3>
                    <p><strong>3.1</strong> Объектом автоматизации является <span class="error-highlight" data-error="7">металлургическое предприятие</span> полного цикла.</p>

                    <p><strong>3.2</strong> Основные подразделения предприятия:</p>
                    <ul>
                        <li>Доменный цех</li>
                        <li>Сталеплавильный цех</li>
                        <li><span class="error-highlight" data-error="8">Прокатное производство</span></li>
                        <li>Коксохимическое производство</li>
                    </ul>

                    <p><strong>3.3</strong> Производственная мощность составляет <span class="error-highlight" data-error="9">до 12 млн тонн стали в год</span>.</p>

                    <h3>4. ТРЕБОВАНИЯ К СИСТЕМЕ</h3>
                    <p><strong>4.1</strong> <u>Функциональные требования:</u></p>

                    <p><strong>4.1.1</strong> Система должна обеспечивать <span class="error-highlight" data-error="10">сбор и обработку данных</span> с технологического оборудования в режиме реального времени.</p>

                    <p><strong>4.1.2</strong> Формирование отчетности по <span class="error-highlight" data-error="11">производственным показателям</span> должно осуществляться автоматически.</p>

                    <p><strong>4.1.3</strong> Система должна предоставлять возможности <span class="error-highlight" data-error="12">анализа эффективности</span> производственных процессов.</p>

                    <p><strong>4.2</strong> <u>Требования к производительности:</u></p>

                    <p><strong>4.2.1</strong> Время отклика системы на запросы пользователей не должно превышать <span class="error-highlight" data-error="13">3 секунд</span>.</p>

                    <p><strong>4.2.2</strong> Система должна обрабатывать <span class="error-highlight" data-error="14">не менее 10000 транзакций в минуту</span>.</p>
                </div>

                <div class="document-page">
                    <h3>5. ТРЕБОВАНИЯ К ТЕХНИЧЕСКОМУ ОБЕСПЕЧЕНИЮ</h3>
                    <p><strong>5.1</strong> <u>Серверное оборудование:</u></p>

                    <p><strong>5.1.1</strong> Сервер приложений должен иметь характеристики <span class="error-highlight" data-error="15">не менее указанных в приложении А</span>.</p>

                    <p><strong>5.1.2</strong> Сервер базы данных должен обеспечивать <span class="error-highlight" data-error="16">отказоустойчивость на уровне 99.9%</span>.</p>

                    <p><strong>5.2</strong> <u>Требования к сетевой инфраструктуре:</u></p>

                    <p><strong>5.2.1</strong> Пропускная способность локальной сети должна составлять <span class="error-highlight" data-error="17">не менее 1 Гбит/с</span>.</p>

                    <p><strong>5.2.2</strong> Система должна поддерживать протоколы TCP/IP, HTTP/HTTPS.</p>

                    <h3>6. ТРЕБОВАНИЯ К ПРОГРАММНОМУ ОБЕСПЕЧЕНИЮ</h3>
                    <p><strong>6.1</strong> Операционная система сервера: Windows Server 2019 или выше, Linux Ubuntu 20.04 LTS или выше.</p>

                    <p><strong>6.2</strong> Система управления базами данных: Microsoft SQL Server 2019 или PostgreSQL 13.</p>

                    <p><strong>6.3</strong> Веб-сервер: IIS 10.0 или Apache 2.4.</p>

                    <h3>7. ТРЕБОВАНИЯ К ИНФОРМАЦИОННОЙ БЕЗОПАСНОСТИ</h3>
                    <p><strong>7.1</strong> Система должна обеспечивать <u>многуровневую аутентификацию</u> пользователей.</p>

                    <p><strong>7.2</strong> Все данные должны передаваться в зашифрованном виде с использованием протокола TLS 1.3.</p>

                    <p><strong>7.3</strong> Система должна вести журнал всех действий пользователей.</p>
                </div>

                <div class="document-page">
                    <h3>8. ТРЕБОВАНИЯ К ИНТЕРФЕЙСУ ПОЛЬЗОВАТЕЛЯ</h3>
                    <p><strong>8.1</strong> Интерфейс должен быть выполнен в виде веб-приложения, доступного через стандартные браузеры.</p>

                    <p><strong>8.2</strong> Система должна поддерживать адаптивный дизайн для работы на различных устройствах.</p>

                    <p><strong>8.3</strong> Интерфейс должен соответствовать принципам юзабилити и быть интуитивно понятным.</p>

                    <h3>9. ЭТАПЫ СОЗДАНИЯ СИСТЕМЫ</h3>
                    <p><strong>9.1</strong> Проект реализуется в 4 этапа:</p>

                    <p><strong>Этап 1.</strong> Анализ требований и проектирование архитектуры (2 месяца)</p>
                    <p><strong>Этап 2.</strong> Разработка базовой функциональности (6 месяцев)</p>
                    <p><strong>Этап 3.</strong> Интеграция с существующими системами (3 месяца)</p>
                    <p><strong>Этап 4.</strong> Тестирование и ввод в эксплуатацию (2 месяца)</p>

                    <p><strong>9.2</strong> Общий срок реализации проекта: 13 месяцев.</p>

                    <h3>10. ПОРЯДОК КОНТРОЛЯ И ПРИЕМКИ</h3>
                    <p><strong>10.1</strong> Контроль качества выполняемых работ осуществляется на каждом этапе разработки.</p>

                    <p><strong>10.2</strong> Приемка системы производится после успешного завершения всех этапов тестирования.</p>

                    <p><strong>10.3</strong> Заказчик имеет право потребовать устранения выявленных недостатков в течение гарантийного срока.</p>
                </div>

                <div class="document-page">
                    <h3>ПРИЛОЖЕНИЯ</h3>

                    <p><strong>Приложение А.</strong> Технические характеристики серверного оборудования</p>

                    <table border="1" style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                        <tr>
                            <th style="padding: 10px; background: #f0f0f0;">Компонент</th>
                            <th style="padding: 10px; background: #f0f0f0;">Минимальные требования</th>
                        </tr>
                        <tr>
                            <td style="padding: 10px;">Процессор</td>
                            <td style="padding: 10px;">Intel Xeon Gold 6248R или аналог</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;">Оперативная память</td>
                            <td style="padding: 10px;">128 ГБ DDR4</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;">Дисковая подсистема</td>
                            <td style="padding: 10px;">SSD 2 ТБ + HDD 10 ТБ</td>
                        </tr>
                        <tr>
                            <td style="padding: 10px;">Сетевой интерфейс</td>
                            <td style="padding: 10px;">10 GbE</td>
                        </tr>
                    </table>

                    <p style="text-align: center; margin-top: 50px;">
                        <strong>Заказчик:</strong> ОАО "Уральская сталь"<br>
                        <strong>Исполнитель:</strong> ООО "ИТ-Решения"<br><br>
                        Дата составления: ${new Date().toLocaleDateString('ru-RU')}
                    </p>
                </div>
            `;
  }

  // Загрузка комментариев
  function loadComments() {
    const incorrectComments = [
      {
        title: "Неточная формулировка",
        section: "1. Общие положения",
        description: "Необходимо конкретизировать тип системы управления: ERP, MES, SCADA или комплексное решение.",
        errorId: 0
      },
      {
        title: "Размытое определение",
        section: "1. Общие положения",
        description: "Фраза 'автоматизация процессов' слишком общая. Укажите конкретные процессы.",
        errorId: 1
      },
      {
        title: "Отсутствие детализации",
        section: "1. Общие положения",
        description: "Не указано с каким именно оборудованием должна осуществляться интеграция.",
        errorId: 2
      },
      {
        title: "Неконкретные требования",
        section: "2. Назначение и цели",
        description: "Требуется детализация технологических процессов, подлежащих управлению.",
        errorId: 3
      },
      {
        title: "Отсутствие метрик",
        section: "2. Назначение и цели",
        description: "Не определены критерии контроля качества продукции.",
        errorId: 4
      },
      {
        title: "Неполное описание",
        section: "2. Назначение и цели",
        description: "Не указано, какие именно сырье и материалы должны учитываться.",
        errorId: 5
      },
      {
        title: "Некорректная нагрузка",
        section: "2. Назначение и цели",
        description: "Цифра '500 пользователей' не обоснована расчетами.",
        errorId: 6
      },
      {
        title: "Избыточное описание",
        section: "3. Характеристика объекта",
        description: "Достаточно указать 'металлургическое предприятие'.",
        errorId: 7
      },
      {
        title: "Устаревший термин",
        section: "3. Характеристика объекта",
        description: "Используйте современный термин 'прокатное производство'.",
        errorId: 8
      },
      {
        title: "Неточные данные",
        section: "3. Характеристика объекта",
        description: "Уточните актуальную производственную мощность предприятия.",
        errorId: 9
      },
      {
        title: "Общая формулировка",
        section: "4. Требования к системе",
        description: "Конкретизируйте типы данных и их объемы.",
        errorId: 10
      },
      {
        title: "Неопределенность",
        section: "4. Требования к системе",
        description: "Укажите конкретный перечень производственных показателей.",
        errorId: 11
      },
      {
        title: "Размытые критерии",
        section: "4. Требования к системе",
        description: "Определите конкретные методы анализа эффективности.",
        errorId: 12
      },
      {
        title: "Нереалистичные требования",
        section: "4. Требования к системе",
        description: "Время отклика 3 секунды может быть неприемлемо для некоторых операций.",
        errorId: 13
      },
      {
        title: "Завышенные требования",
        section: "4. Требования к системе",
        description: "10000 транзакций в минуту - обоснуйте необходимость такой производительности.",
        errorId: 14
      },
      {
        title: "Ссылка на отсутствующее приложение",
        section: "5. Техническое обеспечение",
        description: "Приложение А не содержит полных характеристик оборудования.",
        errorId: 15
      },
      {
        title: "Нестандартная метрика",
        section: "5. Техническое обеспечение",
        description: "Используйте стандартные показатели доступности (99.95%, 99.99%).",
        errorId: 16
      },
      {
        title: "Минимальные требования",
        section: "5. Техническое обеспечение",
        description: "1 Гбит/с может быть недостаточно для современных требований.",
        errorId: 17
      }
    ];

    const missingComments = [
      {
        title: "Отсутствует описание пользователей",
        section: "2. Назначение и цели",
        description: "Необходимо добавить классификацию пользователей системы и их роли."
      },
      {
        title: "Не указаны ограничения",
        section: "4. Требования к системе",
        description: "Отсутствуют ограничения и предположения для системы."
      },
      {
        title: "Нет требований к масштабируемости",
        section: "4. Требования к системе",
        description: "Необходимо добавить требования к горизонтальному и вертикальному масштабированию."
      },
      {
        title: "Отсутствуют требования к резервному копированию",
        section: "5. Техническое обеспечение",
        description: "Необходимо описать стратегию резервного копирования данных."
      },
      {
        title: "Не указана процедура восстановления",
        section: "5. Техническое обеспечение",
        description: "Отсутствует план восстановления после сбоев (Disaster Recovery)."
      },
      {
        title: "Нет требований к мониторингу",
        section: "6. Программное обеспечение",
        description: "Необходимо добавить требования к системе мониторинга и алертов."
      },
      {
        title: "Отсутствует описание API",
        section: "6. Программное обеспечение",
        description: "Не описаны требования к программным интерфейсам (API)."
      },
      {
        title: "Нет политики паролей",
        section: "7. Информационная безопасность",
        description: "Отсутствуют требования к сложности и сроку действия паролей."
      },
      {
        title: "Не указаны роли и права доступа",
        section: "7. Информационная безопасность",
        description: "Необходимо описать матрицу ролей и прав доступа."
      },
      {
        title: "Отсутствует процедура аудита",
        section: "7. Информационная безопасность",
        description: "Не описана процедура проведения аудита безопасности."
      },
      {
        title: "Нет требований к доступности",
        section: "8. Интерфейс пользователя",
        description: "Отсутствуют требования к доступности для пользователей с ограниченными возможностями."
      },
      {
        title: "Не указаны браузеры",
        section: "8. Интерфейс пользователя",
        description: "Необходимо указать поддерживаемые браузеры и их версии."
      },
      {
        title: "Отсутствуют критерии приемки",
        section: "9. Этапы создания",
        description: "Не определены конкретные критерии приемки для каждого этапа."
      },
      {
        title: "Нет описания рисков",
        section: "9. Этапы создания",
        description: "Отсутствует анализ рисков проекта и план их митигации."
      }
    ];

    // Заполняем комментарии "Некорректное написание"
    const incorrectContainer = document.getElementById('incorrectComments');
    incorrectComments.forEach((comment, index) => {
      const card = createCommentCard(comment, `incorrect-${index}`, true);
      incorrectContainer.appendChild(card);
    });

    // Заполняем комментарии "Отсутствуют"
    const missingContainer = document.getElementById('missingComments');
    missingComments.forEach((comment, index) => {
      const card = createCommentCard(comment, `missing-${index}`, false);
      missingContainer.appendChild(card);
    });

    // Инициализируем правильную высоту для открытого аккордеона
    setTimeout(() => {
      const openSection = document.querySelector('.accordion-section.open');
      if (openSection) {
        const content = openSection.querySelector('.accordion-content');
        content.style.maxHeight = content.scrollHeight + 'px';
        setTimeout(() => {
          content.style.maxHeight = 'none';
        }, 50);
      }
    }, 100);
  }

  // Создание карточки комментария
  function createCommentCard(comment, id, hasErrorId = false) {
    const card = document.createElement('div');
    card.className = 'comment-card';
    card.id = id;

    if (hasErrorId && comment.errorId !== undefined) {
      card.setAttribute('data-error-id', comment.errorId);
      card.onclick = () => highlightError(comment.errorId, id);
    }

    card.innerHTML = `
                <div class="comment-title">${comment.title}</div>
                <div class="comment-section">${comment.section}</div>
                <div class="comment-description">${comment.description}</div>
            `;

    return card;
  }

  // Обработчики для выделенных ошибок в тексте
  function addErrorHighlightHandlers() {
    const highlights = document.querySelectorAll('.error-highlight');
    highlights.forEach(highlight => {
      highlight.addEventListener('click', (e) => {
        const errorId = parseInt(e.target.getAttribute('data-error'));
        scrollToComment(errorId);
      });
    });
  }

  // Подсветка ошибки в тексте и скролл к ней
  function highlightError(errorId, commentId) {
    // Убираем предыдущую активную подсветку
    document.querySelectorAll('.error-highlight.active').forEach(el => {
      el.classList.remove('active');
    });
    document.querySelectorAll('.comment-card.active').forEach(el => {
      el.classList.remove('active');
    });

    // Находим элемент с ошибкой
    const errorElement = document.querySelector(`[data-error="${errorId}"]`);
    const commentElement = document.getElementById(commentId);

    if (errorElement && commentElement) {
      // Активируем подсветку
      errorElement.classList.add('active');
      commentElement.classList.add('active');

      // Скроллим к ошибке в документе
      errorElement.scrollIntoView({
        behavior: 'smooth',
        block: 'center'
      });

      currentActiveError = errorId;
    }
  }

  // Скролл к комментарию
  function scrollToComment(errorId) {
    // Убираем предыдущую активную подсветку
    document.querySelectorAll('.error-highlight.active').forEach(el => {
      el.classList.remove('active');
    });
    document.querySelectorAll('.comment-card.active').forEach(el => {
      el.classList.remove('active');
    });

    // Находим соответствующий комментарий
    const commentElement = document.querySelector(`[data-error-id="${errorId}"]`);
    const errorElement = document.querySelector(`[data-error="${errorId}"]`);

    if (commentElement && errorElement) {
      // Активируем подсветку
      commentElement.classList.add('active');
      errorElement.classList.add('active');

      // Скроллим к комментарию
      commentElement.scrollIntoView({
        behavior: 'smooth',
        block: 'center'
      });

      currentActiveError = errorId;
    }
  }

  // Управление аккордеоном
  function toggleAccordion(sectionId) {
    const section = document.getElementById(sectionId);
    const content = section.querySelector('.accordion-content');
    const isOpen = section.classList.contains('open');

    if (isOpen) {
      // Закрываем
      content.style.maxHeight = content.scrollHeight + 'px';
      setTimeout(() => {
        content.style.maxHeight = '0';
      }, 10);
      section.classList.remove('open');
    } else {
      // Открываем
      section.classList.add('open');
      content.style.maxHeight = content.scrollHeight + 'px';

      // После анимации убираем ограничение высоты
      setTimeout(() => {
        if (section.classList.contains('open')) {
          content.style.maxHeight = 'none';
        }
      }, 300);
    }
  }
</script>
</body>
</html>